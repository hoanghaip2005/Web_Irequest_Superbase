<div class="content-header">
    <div class="d-flex justify-content-between align-items-center">
        <div>
            <h1 class="page-title">Chi tiết yêu cầu #{{request.RequestID}}</h1>
            <p class="page-subtitle">Xem và xử lý thông tin yêu cầu</p>
        </div>
        <div>
            <a href="/requests" class="btn btn-outline-primary">
                <i class="fas fa-arrow-left me-2"></i>Quay lại
            </a>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-lg-8">
        <div class="card mb-4">
            <div class="card-header">
                <h5 class="card-title mb-0">
                    <i class="fas fa-info-circle me-2"></i>Thông tin yêu cầu
                </h5>
            </div>
            <div class="card-body">
                <div class="row mb-3">
                    <div class="col-sm-3"><strong>Tiêu đề:</strong></div>
                    <div class="col-sm-9">{{request.Title}}</div>
                </div>
                
                <div class="row mb-3">
                    <div class="col-sm-3"><strong>Trạng thái:</strong></div>
                    <div class="col-sm-9">
                        <span class="badge bg-primary">{{request.StatusName}}</span>
                    </div>
                </div>
                
                <div class="row mb-3">
                    <div class="col-sm-3"><strong>Độ ưu tiên:</strong></div>
                    <div class="col-sm-9">
                        <span class="badge bg-warning">{{request.PriorityName}}</span>
                    </div>
                </div>
                
                <div class="row mb-3">
                    <div class="col-sm-3"><strong>Mô tả:</strong></div>
                    <div class="col-sm-9">
                        {{#if request.Description}}
                        <div class="p-3 bg-light rounded">{{request.Description}}</div>
                        {{else}}
                        <em class="text-muted">Không có mô tả</em>
                        {{/if}}
                    </div>
                </div>
                
                <div class="row mb-3">
                    <div class="col-sm-3"><strong>Ngày tạo:</strong></div>
                    <div class="col-sm-9">{{formatDateTime request.CreatedAt}}</div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="col-lg-4">
        <div class="card">
            <div class="card-header">
                <h5 class="card-title mb-0">
                    <i class="fas fa-cog me-2"></i>Thao tác
                </h5>
            </div>
            <div class="card-body">
                <a href="/requests/{{request.RequestID}}/edit" class="btn btn-primary w-100 mb-2">
                    <i class="fas fa-edit me-2"></i>Chỉnh sửa
                </a>
                <button class="btn btn-danger w-100" onclick="deleteRequest({{request.RequestID}})">
                    <i class="fas fa-trash me-2"></i>Xóa
                </button>
            </div>
        </div>
    </div>
</div>

<script>
function deleteRequest(requestId) {
    if (!confirm('Bạn có chắc chắn muốn xóa yêu cầu này? Hành động này không thể hoàn tác.')) {
        return;
    }

    fetch(`/requests/${requestId}`, {
        method: 'DELETE',
        headers: {
            'Content-Type': 'application/json'
        }
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            alert('Đã xóa yêu cầu thành công');
            window.location.href = '/requests';
        } else {
            alert(data.error || 'Có lỗi xảy ra khi xóa yêu cầu');
        }
    })
    .catch(error => {
        console.error('Error:', error);
        alert('Không thể xóa yêu cầu. Vui lòng thử lại.');
    });
}
</script>
